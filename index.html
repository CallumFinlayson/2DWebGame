<!DOCTYPE html>
<html>
    <head>
        <title>Capture The Glag Game!</title> 
        <style>
            #canvas {
                border: 1px solid black;
                background-color: whitesmoke;
            }
            #timer {
                font-size: 30px;
                text-align: left;
                color: red;
                text-emphasis: bold;
                font-family: Arial, Helvetica, sans-serif;
                width: 100px;
                height: 30px;
                background-color: black;
            }      
            #timeText {
                font-size: 10px;
                text-align: left;
                color: black;
                text-emphasis: bold;
                font-family: Arial, Helvetica, sans-serif;
                height: 10px;
            }      
        </style>
    </head>
    <body style= "background-color: #B0C4DE";>
        <p id="timeText">Miliseconds left in game: </p>
        <div id="timer">
                300000
        </div>
        <canvas id="canvas" ></canvas>
        <script>

            (function() {
                var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
                window.requestAnimationFrame = requestAnimationFrame;
            })();
    
            //variables
            var player;
            var pwidth = 5;
            var pheight = 5;
            var px = 26;
            var py = 234;
            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");
            var width = 960;
            var height = 640;
            canvas.width = width;
            canvas.height = height;
            var keys = [];
            var gravity = 1;
            var jumping = false;

            //ctx.fillRect(px, py, pwidth, pheight);

            var platforms = {
                start : function() {
                    //making the platforms
                    //red team starting point and red flag start point
                    //ctx.beginPath();
                    ctx.fillStyle = "red";
                    ctx.fillRect(0,240,100,10);
                    //Flag
                    ctx.fillRect(10,209,10,30)
                    //blue team starting point and blue flag start point
                    ctx.fillStyle = "blue";
                    ctx.fillRect(860,240,100,10);
                    //Flag
                    ctx.fillRect(940,209,10,30)

                    //Making the platforms
                    ctx.fillStyle = "black";
                    ctx.fillRect(140,340,75,10); 
                    ctx.fillRect(745,340,75,10); 
                    ctx.fillRect(0,540,75,10); 
                    ctx.fillRect(885,540,75,10); 
                    ctx.fillRect(442.5,490,75,10); 
                    ctx.fillRect(442.5,340,75,10); 
                    ctx.fillRect(140,440,75,10); 
                    ctx.fillRect(745,440,75,10); 
                    ctx.fillRect(291.25,390,75,10); 
                    ctx.fillRect(593.75,390,75,10);
                }
            }

            var updatePlayer = {
                start : function() {
                    if (px >= width-pwidth) {
                        px = width- pwidth;
                    } else if (px <= 0) {         
                        px = 0;     
                    } else if(py >= height-pheight){
                        py = height - pheight;
                        player.jumping = false;
                    } else if (py <=0){
                        py = 0;
                    }
                    ctx.clearRect(0,0,width,height);
                    ctx.fillStyle = "red";
                    ctx.fillRect(px, py, pwidth, pheight);
                    platforms.start();
                }
            }

            var time = 300000;
            function timer() {
                setTimeout(function(){
                    var timerDiv = document.getElementById("timer");
                    time = time-1;
                    timerDiv.innerHTML = time;
                    //timer();
                }, 1000)
            }

            function checkTime() {
                if (time <= 0) {
                    //end game
                }
            }

            function playerOnPlatform() {
                //red base
                if (((0>=px)&&(px<=100))&&((234<=py)&&(py>=250))) { //ctx.fillRect(0,240,100,10);
                    jumping = false;
                    py = 234;
                }
                //blue base
                if (((860>=px)&&(px<=960))&&((234<=py)&&(py>=250))) { //ctx.fillRect(860,240,100,10);
                    jumping = false;
                    py = 234;
                }
                //black platforms
                if (((140>=px)&&(px<=215))&&((334<=py)&&(py>=350))) { //ctx.fillRect(140,340,75,10);
                    jumping = false;
                    py = 334;
                }
                if (((745>=px)&&(px<=820))&&((334<=py)&&(py>=350))) { //ctx.fillRect(745,340,75,10);
                    jumping = false;
                    py = 334;
                }
                if (((0>=px)&&(px<=75))&&((534<=py)&&(py>=550))) { //ctx.fillRect(0,540,75,10);
                    jumping = false;
                    py = 534;
                }
                if (((885>=px)&&(px<=960))&&((534<=py)&&(py>=550))) { //ctx.fillRect(885,540,75,10);
                    jumping = false;
                    py = 534;
                }
                if (((442.5>=px)&&(px<=517.5))&&((484<=py)&&(py>=500))) { //ctx.fillRect(442.5,490,75,10);
                    jumping = false;
                    py = 484;
                }
                if (((442.5>=px)&&(px<=517.5))&&((334<=py)&&(py>=350))) { //ctx.fillRect(442.5,340,75,10);
                    jumping = false;
                    py = 334;
                }
                if (((140>=px)&&(px<=215))&&((434<=py)&&(py>=450))) { //ctx.fillRect(140,440,75,10);
                    jumping = false;
                    py = 434;
                }
                if (((745>=px)&&(px<=820))&&((434<=py)&&(py>=450))) { //ctx.fillRect(745,440,75,10);
                    jumping = false;
                    py = 434;
                }
                if (((291.25>=px)&&(px<=366.25))&&((384<=py)&&(py>=400))) { //ctx.fillRect(291.25,390,75,10);
                    jumping = false;
                    py = 384;
                }
                if (((593.75>=px)&&(px<=668.75))&&((384<=py)&&(py>=400))) { //ctx.fillRect(593.75,390,75,10);
                    jumping = false;
                    py = 384;
                } 
            }
            
            //game functionallity
            function update() {
                timer();

                // check keys
                if (keys[38]) {
                    // up arrow
                    py = py -3;
                    pwidth = 5;
                    pheight = 5;
                    jumping = true;
                    playerOnPlatform();
                }
                if (keys[39]) {
                    // right arrow
                    px = px + 1;
                    pwidth = 5;
                    pheight = 5;
                    jumping = true;
                    playerOnPlatform();
                }                              
                if (keys[37]) { 
                    //left arrow
                    px = px -1;
                    pwidth = 5;
                    pheight = 5;
                    jumping = true;
                    playerOnPlatform();
                }

                if (jumping) {
                    playerOnPlatform();
                    py = py + gravity;
                }

                if (px >= width-pwidth) {
                    px = width- pwidth;
                } else if (px <= 0) {         
                    px = 0;     
                } else if(py >= height-pheight){
                    py = height - pheight;
                    player.jumping = false;
                } else if (py <=0){
                    py = 0;
                }

                playerOnPlatform();

                ctx.clearRect(0,0,width,height);
                ctx.fillStyle = "red";
                ctx.fillRect(px, py, pwidth, pheight);
                platforms.start();

                requestAnimationFrame(update);
            }
            
            document.body.addEventListener("keydown", function(e) {
                keys[e.keyCode] = true;
            });
 
            document.body.addEventListener("keyup", function(e) {
                keys[e.keyCode] = false;
            });    
                
            window.addEventListener("load", function(){
                update();
            });   
                
        </script>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 15px;">My Team Score: </p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 15px;">Opponent Team Score: </p>
    <p> </p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 12px;">Game Instructions:</p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">up arrow to jump</p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">left right arrows to move left and right</p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">space to freeze other players</p>
    </body>
</html>
