<!DOCTYPE html>
<html>
    <head>
        <title>Capture The Glag Game!</title> 
        <style>
            #canvas {
                border: 4px solid black;
                background-color: whitesmoke;
            }
            #timer {
                font-size: 30px;
                text-align: left;
                color: red;
                text-emphasis: bold;
                font-family: Arial, Helvetica, sans-serif;
                width: 100px;
                height: 30px;
                background-color: black;
            }      
            #timeText {
                font-size: 10px;
                text-align: left;
                color: black;
                text-emphasis: bold;
                font-family: Arial, Helvetica, sans-serif;
                height: 10px;
            }      
        </style>
    </head>
    <body style= "background-color: #B0C4DE";>
        <p id="timeText">Miliseconds left in game: </p>
        <div id="timer">
                10000
        </div>
        <canvas id="canvas" ></canvas>
        <script>
            (function() {
                var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
                window.requestAnimationFrame = requestAnimationFrame;
            })();
    
            //variables
            //var player;
            var pwidth = 5;
            var pheight = 5;
            var PlayerXstartX = 26;
            var PlayerXstartY = 234;
            var PlayerYstartX = 929;
            var PlayerYstartY = 234;
            var px;
            var py;
            
            //
            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");
            var width = 960;
            var height = 640;
            canvas.width = width;
            canvas.height = height;
            //var keys = [];
            //var gravity = 1;
            //var jumping = false;
            var xTeamSize;
            var yTeamSize;
            var xScoreLabel; //Text value
            var yScoreLabel; //Text value
            var xTeamScore = 0; //Int value
            var yTeamScore = 0; //Int value
            var isPlayerX = false;
            var isPlayerY = false;
            var playerColour;
            var Xcolour = "red";
            var Ycolour = "blue";
            //var onPlatform = false;
            flagCarryingByX = false;
            flagCarryingByY = false;
            //var playerSpeed;
            //var jumpSpeed = 4;
            
            
            function setTeamCreatePlayer() {
                if ((xTeamSize < 3) && (xTeamSize != 3)) {
                    //The player will be xTeam
                    xTeamSize = xTeamSize + 1;
                    PlayerXstartY = PlayerXstartY + 6;
                    isPlayerX = true;
                    createPlayer();
                } else if ((yTeamSize < 3) && (yTeamSize != 3)) {
                    //The player will be yTeam
                    yTeamSize = yTeamSize + 1;
                    PlayerYstartY = PlayerYstartY - 6;
                    isPlayerY = true;
                    createPlayer();
                } else if ((xTeamSize == 3) && (yTeamSize == 3)) {
                    //The teams are full stop calling this function and adding players
                    update();
                }
            }
            function createPlayer() {
                if (isPlayerX) {
                    playerColour = Xcolour;
                    px = PlayerXstartX;
                    py = PlayerXstartY;
                } else if (isPlayerY) {
                    playerColour = Ycolour;
                    px = PlayerYstartX;
                    py = PlayerYstartY;
                }
            }

            var platforms = {
                start : function() {
                    //making the platforms
                    //red team starting point and red flag start point
                    //ctx.beginPath();
                    ctx.fillStyle = "red";
                    ctx.fillRect(0,240,100,10);
                    //Flag
                    if (!flagCarryingByY) {
                        ctx.fillRect(10,209,10,30);
                    }
                    //blue team starting point and blue flag start point
                    ctx.fillStyle = "blue";
                    ctx.fillRect(860,240,100,10);
                    //Flag
                    if (!flagCarryingByX) {
                        ctx.fillRect(940,209,10,30);
                    }
                    //Making the platforms
                    ctx.fillStyle = "black";
                    ctx.fillRect(140,340,75,10); 
                    ctx.fillRect(745,340,75,10); 
                    ctx.fillRect(0,540,75,10); 
                    ctx.fillRect(885,540,75,10); 
                    ctx.fillRect(442.5,490,75,10); 
                    ctx.fillRect(442.5,340,75,10); 
                    ctx.fillRect(140,440,75,10); 
                    ctx.fillRect(745,440,75,10); 
                    ctx.fillRect(291.25,390,75,10); 
                    ctx.fillRect(593.75,390,75,10);
                    //Floor of the canvas 
                    //return player to start position if they hit this
                    ctx.fillStyle = "orange";
                    ctx.fillRect(0,630,960,10);
                }
            }

            var time = 15000;
            function timer() {
                setTimeout(function(){
                    var timerDiv = document.getElementById("timer");
                    if (time >= 1) {
                        time = time-1;
                    }
                    timerDiv.innerHTML = time;
                    checkTime();
                    //timer();
                }, 1000)
            }
            function closeGame() {
                open("endpage.html");
            }
            function checkTime() {
                if (time <= 0) {
                    // end game
                    open("endpage.html");
                    close("main.html");
                }
            } 

            function start() {
                platforms.start();
                timer();
            }

            window.addEventListener("load", function(){
                //createPlayers();
                start();
            });  
                
        </script>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 12px;">Game Instructions:</p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">up arrow to jump</p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">left right arrows to move left and right</p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">space to freeze other players</p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">The floor is lava!! (Don't fall)</p>
    <p style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">GOOD LUCK</p>
    </body>
</html>
